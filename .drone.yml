---
kind: pipeline
name: default

steps:
- name: submodules
  image: alpine/git
  commands:
  - git submodule update --init


- name: syntaxcheck
  image: monachus/hugo:v0.75.1
  commands:
  - hugo

- name: deploy
  image: appleboy/drone-scp
  settings:
    host:
      - pfadfinder-konstanz.de
    user: pfadiskn
    key:
      from_secret: ssh_key
    port: 22
    command_timeout: 2m
    target: /var/www/virtual/pfadiskn/html/
    source: public/*
    rm: true
    strip_components: 1
